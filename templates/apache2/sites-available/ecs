# Virtualhost Client http(s)://%(hostname)s

#NameVirtualhost %(ip)s:443

<VirtualHost *:443>
    ServerName %(hostname)s
    ServerAlias *.%(hostname)s
    ServerAdmin postmaster@%(hostname)s

    SSLEngine on
    SSLCertificateFile "/etc/ssl/certs/%(hostname)s.pem"
    SSLCertificateKeyFile "/etc/ssl/private/%(hostname)s.key"

    SSLCACertificateFile "%(ca_certificate_file)s"
    SSLCARevocationFile "%(ca_revocation_file)s"
    SSLVerifyClient none
    
    <Location /secure>
        SSLRequireSSL
        SSLVerifyClient require
        SSLVerifyDepth 1
    </Location>
    
    DocumentRoot %(home)s/empty_html
    <Directory "%(home)s/empty_html">
        Options FollowSymLinks
        AllowOverride Authconfig FileInfo Indexes Limit Options=Indexes
    </Directory>
    
    Include /etc/apache2/ecs/apache.conf/*.conf
</VirtualHost>

<VirtualHost %(hostname)s:80>
    ServerName %(hostname)s
    ServerAdmin postmaster@%(hostname)s

    DocumentRoot %(home)s/empty_html
    <Directory "%(home)s/empty_html">
        Options FollowSymLinks
        AllowOverride Authconfig FileInfo Indexes Limit Options=Indexes
    </Directory>
        
    Redirect permanent / https://%(hostname)s/
</VirtualHost>
