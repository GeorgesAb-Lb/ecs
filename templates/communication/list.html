{% extends "core.html" %}
{% load i18n core communication %}

{% block menuSelection %}communication{% endblock %}

{% block htmltitle %}{% trans "Communication" %} | {{ block.super }}{% endblock %}
{% block headertitle %}{% trans "Communication" %} ({{ page.paginator.count }}){% endblock %}

{% block content %}
  <table class="messages">
      <tr>
          <th>{% trans "Date" %}</th>
          <th>{% trans "Subject" %}</th>
          <th>{% trans "Read" %}</th>
          {% block extra_message_table_headers %}
              <th>Von</th>
              <th>An</th>
          {% endblock %}
          <th></th>
      </tr>
  {% for thread in page.object_list %}
      <tr>
          <td>{{ thread.last_message.timestamp|date:'d.m.Y, H:i:s' }} Uhr</td>
          <td>
              <a href="{% url 'ecs.communication.views.read_thread' thread_pk=thread.pk %}">
                  {% if thread.submission %}{{ thread.submission|ec_number }} - {% endif %}
                  {{ thread.subject }}
              </a>
          </td>
          <td>{{ thread.last_message.unread|yesno:'Nein,Ja' }}</td>
          {% block extra_message_table_cells %}
              <td>{{ thread.last_message.sender }}</td>
              <td>{{ thread.last_message.receiver }}</td>
          {% endblock %}
          <td>
              {% if not thread|closed_by:user %}
                  <a class="open-in-widget fa fa-check-square-o" href="{% url 'ecs.communication.views.close_thread' thread_pk=thread.pk %}?next={{ request.path|urlencode }}" title="{% trans 'mark as done' %}"></a>
              {% endif %}
          </td>
      </tr>
  {% endfor %}
  </table>
  
  <div class="paginator text-xs-center">
      {% if page.has_previous %}
          <a class="open-in-widget fa fa-fast-backward" href="{{ request.path }}?p=1"></a>
          <a class="open-in-widget fa fa-backward" href="{{ request.path }}?p={{ page.previous_page_number }}&amp;sort={{ sort }}"></a>
      {% endif %}
      {% trans "Page" %} {{ page.number }} {% trans "of" %} {{ page.paginator.num_pages }}
      {% if page.has_next %}
          <a class="open-in-widget fa fa-forward" href="{{ request.path }}?p={{ page.next_page_number }}&amp;sort={{ sort }}"></a>
          <a class="open-in-widget fa fa-fast-forward" href="{{ request.path }}?p={{ page.paginator.num_pages }}&amp;sort={{ sort }}"></a>
      {% endif %}
  </div>
  <div class="hint mt-1">{% block hint %}{% endblock %}</div>

{% endblock %}
