{% extends 'core.html' %}
{% load core %}

{% block htmltitle %}ECS Elektronische Einreichung{% endblock %}

{% block headertitle %}
Sitzungsassistent
{% endblock %}

{% block menuSelection %}meetings{% endblock %}

{% block content %}
<div id="meeting_assistant">
    <div class="left">
      <h4>Navigation</h4>
        {% with meeting.open_tops.count as open_top_count %}
            <a href="{% url ecs.core.views.meeting_assistant_clear meeting_pk=meeting.pk %}">Clear</a>
            {% if not meeting.started %}
                | <a href="{% url ecs.core.views.meeting_assistant_start meeting_pk=meeting.pk %}">Start</a>
            {% else %}
                {% if not meeting.ended and open_top_count == 0 %}
                    | <a href="{% url ecs.core.views.meeting_assistant_stop meeting_pk=meeting.pk %}">Stop</a>
                {% endif %}
            {% endif %}
            <ol class="info">
                <li>TOPs: {{ meeting|length }}</li>
                <li>Offene TOPs: {{ open_top_count }}</li>
                <li>Offene TOPs mit Votum: {{ meeting.open_tops_with_vote.count }}</li>
                <li>&nbsp;</li>
                <li>
                    {% if meeting.started %}
                        Beginn: {{ meeting.started|date:'H:i' }} Uhr
                    {% else %}
                        Noch nicht begonnen.
                    {% endif%}
                </li>
                <li>Geplanter Beginn: {{ meeting.start|date:'H:i' }} Uhr
                </li>
                <li>Geplantes Ende: {{ meeting.end|date:'H:i' }} Uhr
                </li>
                {% if meeting.ended %}
                    <li>Ende: {{ meeting.ended|date:'H:i' }} Uhr</li>
                {% endif %}
                <li>
                    Aktuelle Uhrzeit: <span id="clock">{% now "H:i" %}</span> Uhr
                </li>
            </ul>
            <div class="navigation">
              <h4>Wechsle nach:</h4>
                {% if meeting.started %}
                    {% block meeting_assistant_navigation %}
                        <form action="{% url ecs.core.views.meeting_assistant_quickjump meeting_pk=meeting.pk %}">
                            <input type="text" name="q"/><input type="submit" value="Suchen" />
                        </form>
                    {% endblock %}
                {% endif %}
            </div>
        {% endwith %}
    </div>
    <div id="meeting_assistant_body">
        {% if not meeting.open_tops.exists and meeting.started and not meeting.ended %}<span style="color:red">Alle TOPs wurden geschlossen. Sie k√∂nnen die Sitzung jetzt beenden.</span>{% endif %}
        {% block meeting_assistant_body %}
        {% endblock %}
    </div>
    <div class="right">
        {% block meeting_assistant_sidebar %}{% endblock %}
    </div>
</div>
{% endblock %}

{% block jsbottom %}
{{ block.super }}
<script type="text/javascript">
    window.addEvent('domready', function(){
        setInterval(function(){
            $('clock').innerHTML = (new Date()).format('%H:%M');
        }, 6000);
    });
</script>
{% endblock %}
