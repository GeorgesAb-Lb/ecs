{% extends "help/base.html" %}
{% load i18n userutils helputils %}

{% block upload_params %}{% if page.view_id %}&amp;view={{ page.view_id }}{% endif %}&amp;page={{ page.id }}{% endblock %}
      
{% block content %}
    <h2>{{ page.title }}</h2>

    <div class="restructuredtext">
        {{ page.publish_parts.fragment|safe }}
    </div>

    <div class="nav">
    {% with page|prevtopnext as nav %}
        <span class="prev">
        {% if nav.prev %}
            <a href="{% url ecs.help.views.view_help_page page_pk=nav.prev.pk %}"><span class="prev_page" style="display: inline-block;"></span>{{ nav.prev.title }}</a>
        {% endif %}
        </span>
        <span class="top">
        {% if nav.top %}
            {% trans 'Chapter' %}: <a href="{% url ecs.help.views.view_help_page page_pk=nav.top.pk %}">{{ nav.top.title }}</a>
        {% endif %}
        </span>
        <span class="next">
        {% if nav.next %}
            <a href="{% url ecs.help.views.view_help_page page_pk=nav.next.pk %}">{{ nav.next.title }}<span class="next_page"></span></a>
        {% endif %}
        </span>
    {% endwith %}
    </div>
{% endblock %}

{% block nav_left %}
    {% if user|has_flag:"is_help_writer" %}
        <span class="help_edit">
            <a href="{% url ecs.help.views.edit_help_page page_pk=page.pk %}">edit</a> 
        </span>
        | <span class="location">
            {{ page.view.path }}{% if page.anchor %} #{{ page.anchor }}{% endif %} 
        </span>
        | <span class="help_diff">
            <a href="{% url ecs.help.views.difference_help_pages page_pk=page.pk %}">Version: {{ versions }} ({% trans "last edited" %} {{ current.revision.date_created|timesince }} {% trans "ago by" %} {{ current.revision.user }})</a>
        </span>
        <span class="help_review_status {{ page.review_status }}">
            | Status: {{ page.get_review_status_display }}
        </span>
        {% if page.review_status == 'new' %}
            | <span class="help_review_status">
                <a href="{% url ecs.help.views.ready_for_review page_pk=page.pk %}">ready for review</a>
            </span>
        {% endif %}
        {% if page.review_status == 'ready_for_review' %}
            | <span class="help_review_status">
                <a href="{% url ecs.help.views.review_ok page_pk=page.pk %}">review ok</a> 
            </span>
            | <span class="help_review_status">
                <a href="{% url ecs.help.views.review_fail page_pk=page.pk %}">review fail</a> 
            </span>
        {% endif %}
        {% if page.review_status == 'review_ok' or page.review_status == 'review_fail' %}
            | <span class="help_review_status">
                <a href="{% url ecs.help.views.ready_for_review page_pk=page.pk %}">review again</a> 
            </span>
        {% endif %}
    {% endif %}
{% endblock %}
      
      

