{% load i18n core widget_tweaks %}

<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">&times;</button>
    {% if submission %}
        <h4 class="modal-title">{% blocktrans with submission|ec_number as ec_number %}Scratchpad for submission {{ ec_number }}{% endblocktrans %}</h4>
    {% else %}
        <h4 class="modal-title">{% trans "Scratchpad" %}</h4>
    {% endif %}
    <a href="{% url 'ecs.scratchpad.views.popup_list' %}">{% trans "Show all my scratchpads" %}</a>
</div>

<div class="modal-body">
    <form id="scratchpad_form" action="{% url 'ecs.scratchpad.views.popup' scratchpad_pk=scratchpad.pk %}{% if submission %}?submission={{ submission.pk }}{% endif %}" method="post">
        {% csrf_token %}
        {{ form.text|add_class:'form-control' }}
    </form>

    <span class="modified_at">{% blocktrans with scratchpad.modified_at|date:"d.m.Y, H:i:s" as modified_at %}Last Change: {{ modified_at }}{% endblocktrans %}</span>
    {# do not remove classes from buttons or anywhere else! #}
</div>

<div class="modal-footer">
    <button type="button" class="btn btn-primary btn-block" data-dismiss="modal">{% trans "Save and close" %}</button>
</div>

{% if user.profile.is_internal %}
    <script type="text/javascript">
        new ecs.textarea.TextArea('.modal-content textarea[name="text"]', [
            ecs.textarea.toolbarItems.boilerplate(
                "{{ _('Insert Boilerplate')|escapejs }}",
                "{% url 'ecs.boilerplate.views.select_boilerplate' %}"
            )
        ], {update_height: false});
    </script>
{% endif %}
