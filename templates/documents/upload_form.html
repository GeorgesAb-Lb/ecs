{% extends 'documents/iframe.html' %}
{% load core i18n %}

{% block actions %}
    {{ block.super }}
    <a href="{% block delete_url %}{% endblock %}?document_pk={{ doc.pk }}" class="delete_document">{% trans "Delete" %}</a>
    | <a href="" class="replace_document">{% trans "Replace" %}</a>
    <input type="hidden" name="documents" value="{{ doc.pk }}" />
    <span class="document_display_name" style="display:none;">
        {% if doc.name %}
        {{ doc.name|smart_truncate:100 }}
        {% else %}
        Dateiname: {{ doc.original_file_name|smart_truncate:100 }}
        {% endif %}
        - {{ doc.version|smart_truncate:100 }} vom {{ doc.date|date:'d.m.Y' }}
    </span>
    <span class="document_name" style="display:none;">{{ doc.name }}</span>
    <span class="document_type" style="display:none;">{{ doc.doctype.pk }}</span>
{% endblock %}

{% block document_list %}
    {{ block.super }}
    {% block extra_hint %}{% endblock %}
    <div class="form form_main document_upload">
        <form action="" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <ol>
                {% for hidden in form.hidden_fields %}
                    {{ hidden }}
                {% endfor %}
                {% for field in form %}
                    {% if not field.is_hidden %}
                        {% include "forms/field.html" %}
                    {% endif %}
                {% endfor %}
                <div class="hint">
                    <span class="icon_comment"></span>{% trans "Use the calendar icon to select a date." %}
                </div>
                <li style="display:none;">
                    {% trans "Replaces document" %} <span id="replaced_document_name"></span>
                    <a href="" class="new_document">{% trans "New Document" %}</a>
                </li>
            </ol>
            <input type="submit" name="upload" value="{% trans 'Upload' %}" />
            <div class="warning">
                <span class="icon_warning"></span>{% trans "Please be patient, the file is being uploaded and processed" %}
            </div>
            </div>
        </form>
    </div>
{% endblock %}

{% block jsbottom %}
    {{ block.super }}
    <script type="text/javascript"> 
        window.addEvent('domready', function(){
            ecs.setupDocumentUploadForms();
        });
    </script>
{% endblock %}
