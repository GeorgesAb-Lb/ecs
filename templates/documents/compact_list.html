{# context: documents #}
{% load core i18n userutils %}

<div class="document_container">
{% block document_list %}
<div class="doclist">

{% for doc in documents %}
    {% ifchanged doc.doctype.identifier %}
        <h4>{{ doc.doctype }}</h4>
    {% endifchanged %}

    <div class="list_item">
        {% block actions %}
            {% if doc.status == 'ready' %}
                {% if doc.doctype.is_downloadable or user|has_flag:'is_internal' %}
                    <a href="{% url ecs.documents.views.download_document document_pk=doc.pk %}">{% trans "Download" %}</a> | 
                {% endif %}
		<a href="{% url ecs.documents.views.view_document document_pk=doc.pk %}" target="_blank">{% trans "View" %}</a> | 
            {% endif %}
        {% endblock %}
        <a class="doc_name" href="{% url ecs.documents.views.view_document document_pk=doc.pk %}" target="_blank">
            {% if doc.name %}
            {{ doc.name }}
            {% else %}
            Dateiname: {{ doc.original_file_name }}
            {% endif %} 
            -  <em>Version {{ doc.version }} vom {{ doc.date|date:'d.m.Y' }}</em>
            {% if not doc.status == 'ready' %}
                <span class="status">
                    {{ doc.get_status_display }}
                </span>
            {% endif %}
            {% if doc.original_file_name %}{% endif %}
        </a><br />
    </div>
{% empty %}
    <p>Noch keine Unterlagen</p>
{% endfor %}

</div>
{% endblock %}
</div>
